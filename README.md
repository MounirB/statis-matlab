# Méthode STATIS
STATIS est une méthode exploratoire d’analyse des données utilisée pour les données quantitatives. [Escouffier et L’Hermier des Plantes, 1976]. Elle réalise l’exploration simultanée de plusieurs tableaux de données recueillis sur les mêmes individus. Le nombre de variables peut différer d’un tableau à un autre. On parle communément de T études <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/9d70300a0ba22e91623214ce670eb7a2.svg?invert_in_darkmode" align=middle width=132.836715pt height=24.56552999999997pt/>.\newline
  Il est à noter qu'une étude est le triplet (X, M, D), où:
    \begin{itemize}
    \item X est le tableau de données centré croisant individus et variables;
    \item M est la métrique  permettant le calcul de distances entre individus, de taille $n*n$;
    \item D est la métrique des poids, permettant le calcul de distances entre variables, de taille $p*p$.
    \end{itemize}

  Le but de STATIS est la recherche d’une structure commune aux études, appelée infrastructure. Pour la mettre en place, il faut passer par les quatre étapes successives  suivantes :  
## Étude de l’interstructure
  On y compare globalement les T tableaux de données. L'objet <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/dc92b47a36c3a7e426608cd76609eb7f.svg?invert_in_darkmode" align=middle width=20.414460000000002pt height=22.381919999999983pt/> est représentatif de l'étude (t). Il est exprimé par la formule suivante :
  <p align="center"><img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/963c0a14c4b4cc0656a4030d7024a1b6.svg?invert_in_darkmode" align=middle width=402.00435pt height=17.250255pt/></p>
  Le produit scalaire de Hilbert-Schmidt est utilisé pour définir une distance entre objets <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/dc92b47a36c3a7e426608cd76609eb7f.svg?invert_in_darkmode" align=middle width=20.414460000000002pt height=22.381919999999983pt/>.
  <p align="center"><img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/f753f5804e5485bf8f4403a13ee523a2.svg?invert_in_darkmode" align=middle width=457.69019999999995pt height=16.376943pt/></p>
  A partir de ce produit est définie la norme de l’objet <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/dc92b47a36c3a7e426608cd76609eb7f.svg?invert_in_darkmode" align=middle width=20.414460000000002pt height=22.381919999999983pt/> et la distance entre les objets <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/dc92b47a36c3a7e426608cd76609eb7f.svg?invert_in_darkmode" align=middle width=20.414460000000002pt height=22.381919999999983pt/> et <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/ead82271df4469ca0a9650a68aabf0b3.svg?invert_in_darkmode" align=middle width=24.02532pt height=22.381919999999983pt/>:
  <p align="center"><img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/3d81f365aafddf6e8ef951e3754a4193.svg?invert_in_darkmode" align=middle width=469.58175pt height=45.25554pt/></p>
  <p align="center"><img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/ac6432eaba43b077ba411cb3f9a68919.svg?invert_in_darkmode" align=middle width=607.7148pt height=29.481209999999997pt/></p>

  Dans le cas où les objets ont des normes trop différentes, il est primordial de les normaliser en utilisant l'objet normé <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/a977c9222312f9115c8dfb6f34428895.svg?invert_in_darkmode" align=middle width=89.169135pt height=24.56552999999997pt/>.
  \newline
  Le produit scalaire permet de déterminer la matrice des produits scalaires entre objets <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/dc92b47a36c3a7e426608cd76609eb7f.svg?invert_in_darkmode" align=middle width=20.414460000000002pt height=22.381919999999983pt/>, appelée S. Sa diagonalisation permet d'obtenir une image euclidienne des T études.
  
  Soit RV, le coefficient d'association qui est une corrélation vectorielle entre études. Il est utile pour l'interprétation de l'interstructure.

  <p align="center"><img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/97a5b923dfb43c558e2446cd2ca36f7a.svg?invert_in_darkmode" align=middle width=520.18725pt height=49.278735pt/></p>

  La valeur de RV varie entre 0 et 1. Plus les deux matrices <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/bd049554fbc115df2fe2a43a4e203ffd.svg?invert_in_darkmode" align=middle width=20.414460000000002pt height=22.381919999999983pt/> et <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/6b5d7345e3853b6818ccb1be4154bc6d.svg?invert_in_darkmode" align=middle width=21.526065000000003pt height=24.668490000000013pt/>  sont similaires et plus sa valeur s'approche de 1.\newline
   
  L'image euclidienne des T études est obtenue, après avoir affecté un poids <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/27d285b8f1cae8a2099968494c307172.svg?invert_in_darkmode" align=middle width=14.282565000000004pt height=14.102549999999994pt/> à chaque étude. Elle sert à visualiser l'interstructure. Soit <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/7e9fe18dc67705c858c077c5ee292ab4.svg?invert_in_darkmode" align=middle width=13.647480000000003pt height=22.381919999999983pt/> une matrice diagonale qui contient tous les poids <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/27d285b8f1cae8a2099968494c307172.svg?invert_in_darkmode" align=middle width=14.282565000000004pt height=14.102549999999994pt/>. \newline 
  Après avoir effectué une ACP de la matrice S, on obtient les points <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/d7da9030d5f375e98e8ebc352a409a6b.svg?invert_in_darkmode" align=middle width=65.1123pt height=22.381919999999983pt/>, qui sont associés aux études <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/d6c58a1141736e75e8aa2d62051a183e.svg?invert_in_darkmode" align=middle width=71.481135pt height=22.381919999999983pt/> dans l'image euclidienne obtenue. Dans ce registre:
  <p align="center"><img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/0952a9393d8e9ca85e106664db561cd4.svg?invert_in_darkmode" align=middle width=602.0734499999999pt height=51.917579999999994pt/></p>
  La distance entre deux points <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/0290da84e4f366644b87b9eda1dc3c0f.svg?invert_in_darkmode" align=middle width=17.229960000000002pt height=22.381919999999983pt/>  et  <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/d82f8ca157a7708206d90d93c376f392.svg?invert_in_darkmode" align=middle width=20.840985pt height=22.381919999999983pt/> est la meilleure approximation possible de la distance de HS entre les objets <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/dc92b47a36c3a7e426608cd76609eb7f.svg?invert_in_darkmode" align=middle width=20.414460000000002pt height=22.381919999999983pt/> et  <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/8bdd311ba939e5d2468336881b02eb5f.svg?invert_in_darkmode" align=middle width=24.02532pt height=22.381919999999983pt/>. Il est à noter que dans ce cadre, <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/be12f35e30b309b106d96b3efddd2fbb.svg?invert_in_darkmode" align=middle width=62.234370000000006pt height=24.668490000000013pt/> représente le cosinus de l'angle entre les vecteurs <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/f41aa33803a367cdb6867260615cebd0.svg?invert_in_darkmode" align=middle width=30.178665000000002pt height=22.381919999999983pt/> et <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/3a1e7c6a178b58d0cb028e710efe0a69.svg?invert_in_darkmode" align=middle width=33.789525pt height=22.381919999999983pt/>.

  Comme dans l'ACP, si l'on ne veut pas que des tableaux interviennent dans la constitution de l'image euclidienne, on les ajoute comme tableaux supplémentaires.


## Recherche d'un compromis
  Un compromis est une moyenne pondérée entre les objets <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/dc92b47a36c3a7e426608cd76609eb7f.svg?invert_in_darkmode" align=middle width=20.414460000000002pt height=22.381919999999983pt/>.
  <p align="center"><img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/0a3cb0d1a2e5650eea6ae30baf9fff4f.svg?invert_in_darkmode" align=middle width=401.97135pt height=47.57808pt/></p>
  Les coefficients <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/9e2b8d7af10391275b0cbe00525e139f.svg?invert_in_darkmode" align=middle width=15.423705000000002pt height=14.102549999999994pt/> sont déterminés en respectant les deux critères suivants : 

  <p align="center"><img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/63d7db398148f316104bccd464047dd1.svg?invert_in_darkmode" align=middle width=673.6207499999999pt height=68.069925pt/></p>

  En considérant <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/2757f268f5a3576b950857a1c4fd5a2c.svg?invert_in_darkmode" align=middle width=15.006915000000003pt height=14.102549999999994pt/> le vecteur propre de S associé à la plus grande valeur propre <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/c349b4874c07d93155bae12e263b4caa.svg?invert_in_darkmode" align=middle width=16.081395pt height=22.745910000000016pt/>, les coefficients <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/9e2b8d7af10391275b0cbe00525e139f.svg?invert_in_darkmode" align=middle width=15.423705000000002pt height=14.102549999999994pt/> sont déterminés comme suit :
  <p align="center"><img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/fb930083ec3126bd5bced20dd9557518.svg?invert_in_darkmode" align=middle width=457.8717pt height=47.57808pt/></p>
 
 <p align="center"><img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/97bbaed0bd3a440011ff44858586eb92.svg?invert_in_darkmode" align=middle width=507.40799999999996pt height=49.131389999999996pt/></p>
  Dans l’image euclidienne des études, le compromis est situé sur le premier axe.

## Étude de l’intrastructure
  L’ACP de la matrice WD fournit l’image euclidienne compromis.
  Soient <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/af4404577ab1384d1dfa9c1aa4b28b4c.svg?invert_in_darkmode" align=middle width=63.431115pt height=14.102549999999994pt/> les valeurs propres de la matrice WD associés aux vecteurs propres <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/12383b636426e58450221bf57a93face.svg?invert_in_darkmode" align=middle width=58.96902000000001pt height=14.102549999999994pt/>. L’image euclidienne compromis des individus est composée des points <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/8aa0fb30eec70c0bb108cbdb197f2c3a.svg?invert_in_darkmode" align=middle width=73.088565pt height=22.381919999999983pt/>; leurs coordonnées sur l’axe k sont les composantes du vecteur :
  <p align="center"><img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/8ce2b713aca12484d2445d9bf7678442.svg?invert_in_darkmode" align=middle width=426.37154999999996pt height=38.430479999999996pt/></p>
  
  L’étude de l’interstructure montre l’existence d’une structure des individus commune aux études, la représentation de l’image euclidienne compromis permet sa description.
  La distance entre deux points <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/50b4930fbe0a5c05a9639621f664da50.svg?invert_in_darkmode" align=middle width=17.05572pt height=22.381919999999983pt/> et <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/afa1876f21c80f24bfc51613c2e1eb27.svg?invert_in_darkmode" align=middle width=18.50376pt height=22.381919999999983pt/> de l’image euclidienne compromis représente la distance compromis entre les individus i et j. Elle est aussi la distance moyenne entre i et j sur la période étudiée.\newline
  
  Il est possible d’interpréter la position des individus sur un axe quelconque, noté k. Pour cela, on calcule les corrélations de la composante principale du compromis correspondant à cet axe avec les variables de chaque étude.
  <p align="center"><img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/4d659a604da5ca9c95602cdec9fcf3f3.svg?invert_in_darkmode" align=middle width=448.61024999999995pt height=21.96051pt/></p>
  Ces corrélations peuvent être résumées sur un graphique. L’étude de ce dernier est utile pour expliquer les positions compromis des individus dans leur image euclidienne.\newline
  Il est à noter que l'image euclidienne compromis est identique à celle trouvée avec une ACP sur une juxtaposition des tableaux initiaux multipliés par <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/a4d8f887ac7716ebfc6dea31c74f085d.svg?invert_in_darkmode" align=middle width=30.001949999999997pt height=22.529760000000014pt/>.

## Représentation des trajectoires des individus
  Les trajectoires décrivent les écarts des objets entre eux et avec le compromis au niveau individuel. Leur représentation se fait dans l’image euclidienne compromis en même temps que les T nuages d’individus débouchant sur une représentation de nT points.
  Pour obtenir la trajectoire, on place les différentes positions d’un individu tel qu’il est décrit par chaque étude (t). On se base sur les coordonnées des points compromis <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/5470b087b677051953439a9bf6f36651.svg?invert_in_darkmode" align=middle width=68.53951500000001pt height=22.381919999999983pt/> sur l’axe k.
  En considérant chaque étude comme étant placée en supplémentaire, les coordonnées des points <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/ad07e638f19de5e096dfbad98663f373.svg?invert_in_darkmode" align=middle width=68.53951500000001pt height=26.033369999999973pt/> sont pour <img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/2e267468a9308904874a78eb3f65733a.svg?invert_in_darkmode" align=middle width=61.464645pt height=22.381919999999983pt/> :
  
  <p align="center"><img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/101cf21778e3022c0cc86da40132323e.svg?invert_in_darkmode" align=middle width=393.75435pt height=38.430479999999996pt/></p>
  
  Ces points n’ont pas influencé la construction de l’image euclidienne compromis, mais ils ont pu y être représentés.
  Les trajectoires décèlent les individus i responsables des écarts entre les études (t) et (t’). Elles s’interprètent par rapport à l’évolution moyenne. Et il y a deux grandes familles de formes de trajectoires:
  <p align="center"><img src="https://rawgit.com/riverarodrigoa/statis-matlab/master/svgs/e48a6754733ecf4e757477e1a9b039db.svg?invert_in_darkmode" align=middle width=673.38645pt height=67.15995pt/></p>
  Si un individu est absent de certaines études, on le place dans l’image euclidienne compromis en le traitant comme un individu supplémentaire et en calculant sa trajectoire.
  Les individus placés en supplémentaire n’interviennent pas dans la détermination de l’infrastructure ni du compromis, ils n’ont pas de position compromis.